<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Population dynamics • WKSP4</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Population dynamics">
<meta property="og:description" content="WKSP4">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WKSP4</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AdditionalRcompadreExercises.html">Additional Rcompadre Exercises</a>
    </li>
    <li>
      <a href="../articles/OtherKeyLHTraits.html">Other key life history traits from MPMs</a>
    </li>
    <li>
      <a href="../articles/PopulationDynamics.html">Population dynamics</a>
    </li>
    <li>
      <a href="../articles/SensitivityElasticity.html">Sensitivity and elasticity matrices</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="PopulationDynamics_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Population dynamics</h1>
            
      
      
      <div class="hidden name"><code>PopulationDynamics.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>The following exercises will focus on how to calculate population dynamics using the <em>popdemo</em> package in R. We will work on:</p>
<ol style="list-style-type: decimal">
<li>Deterministic models</li>
<li>Asymptotic dynamics
<ul>
<li>Calculate asymptotic growth, stable demographic distribution, and reproductive value</li>
</ul>
</li>
<li>Transient dynamics
<ul>
<li>Calculate damping ration, amplification and attenuation</li>
</ul>
</li>
<li>Stochastic dynamics</li>
</ol>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<p>We’ll start by loading the <em>popdemo</em> package.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">popdemo</span><span class="op">)</span> <span class="co"># Activates the package once installed in your library</span>
<span class="co">#&gt; Welcome to popdemo! This is version 1.3-0</span>
<span class="co">#&gt; Use ?popdemo for an intro, or browseVignettes('popdemo') for vignettes</span>
<span class="co">#&gt; Citation for popdemo is here: doi.org/10.1111/j.2041-210X.2012.00222.x</span>
<span class="co">#&gt; Development and legacy versions are here: github.com/iainmstott/popdemo</span></code></pre></div>
</div>
<div id="deterministic-models" class="section level2">
<h2 class="hasAnchor">
<a href="#deterministic-models" class="anchor"></a>Deterministic models</h2>
<p>Deterministic models are those that have no density-dependence and the population matrix is constant (i.e., vital rates do not change overtime (timestep to timestep)).</p>
<p>For this exercise, we will use the population matrix from the desert tortoise <em>Gopherus agassizzii</em> (See Doak et al. (1994) Ecol. Appl., 4, 446-460). This population is found in the Mojave Desert, USA. The matrix has 8 age and size-based stages.</p>
<ul>
<li>Yearling (age 0-1)</li>
<li>Juvenile 1 (&lt;60 mm)</li>
<li>Juvenile 2 (90-99mm)</li>
<li>Immature 1 (100-139mm)</li>
<li>Immature 2 (140-179mm)</li>
<li>Subadult (180-207mm)</li>
<li>Adult 1 (208-239mm)</li>
<li>Adult 2 (&gt;240mm)</li>
</ul>
<p>Let’s add the data.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/utils/data.html">data</a></span><span class="op">(</span><span class="va">Tort</span><span class="op">)</span>
<span class="va">Tort</span>
<span class="co">#&gt;       Yr    J1    J2    I1    I2    SA    A1   A2</span>
<span class="co">#&gt; Yr 0.000 0.000 0.000 0.000 0.000 1.300 1.980 2.57</span>
<span class="co">#&gt; J1 0.716 0.567 0.000 0.000 0.000 0.000 0.000 0.00</span>
<span class="co">#&gt; J2 0.000 0.149 0.567 0.000 0.000 0.000 0.000 0.00</span>
<span class="co">#&gt; I1 0.000 0.000 0.149 0.604 0.000 0.000 0.000 0.00</span>
<span class="co">#&gt; I2 0.000 0.000 0.000 0.235 0.560 0.000 0.000 0.00</span>
<span class="co">#&gt; SA 0.000 0.000 0.000 0.000 0.225 0.678 0.000 0.00</span>
<span class="co">#&gt; A1 0.000 0.000 0.000 0.000 0.000 0.249 0.851 0.00</span>
<span class="co">#&gt; A2 0.000 0.000 0.000 0.000 0.000 0.000 0.016 0.86</span></code></pre></div>
<p>What can you tell about the tortoise population from this matrix?</p>
<p>We will use the function <code>project</code> to obtain the population projection of the desert tortoise over a number of timesteps. We will use one matrix containing a constant set of vital rates (i.e., a deterministic model). Remember that projected population dynamics (time series of population size and structure over time) are obtained by multiplying the constant matrix with the initial population vector. First, we will chose a vector at random.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">vec</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Uniform.html">runif</a></span><span class="op">(</span><span class="fl">8</span><span class="op">)</span></code></pre></div>
<p>Now we will project to 50 time intervals and standardize the vector to sum to 1 with the argument <code>standard.vec</code>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Tortp</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/project.html">project</a></span><span class="op">(</span><span class="va">Tort</span>, <span class="va">vec</span>, time <span class="op">=</span> <span class="fl">50</span>, standard.vec <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="va">Tortp</span>
<span class="co">#&gt; 1 deterministic population projection over 50 time intervals.</span>
<span class="co">#&gt; </span>
<span class="co">#&gt;  [1] 1.0000000 1.3414329 1.5730979 1.7228448 1.8071117 1.8386331 1.8282053</span>
<span class="co">#&gt;  [8] 1.7858563 1.7210223 1.6422158 1.5566242 1.4698610 1.3859253 1.3073359</span>
<span class="co">#&gt; [15] 1.2353755 1.1703830 1.1120444 1.0596501 1.0123041 0.9690778 0.9291126</span>
<span class="co">#&gt; [22] 0.8916789 0.8561998 0.8222513 0.7895454 0.7579061 0.7272417 0.6975187</span>
<span class="co">#&gt; [29] 0.6687387 0.6409210 0.6140888 0.5882608 0.5634460 0.5396424 0.5168363</span>
<span class="co">#&gt; [36] 0.4950047 0.4741166 0.4541360 0.4350236 0.4167392 0.3992426 0.3824953</span>
<span class="co">#&gt; [43] 0.3664605 0.3511039 0.3363936 0.3223002 0.3087961 0.2958558 0.2834555</span>
<span class="co">#&gt; [50] 0.2715727 0.2601859</span></code></pre></div>
<p>The <code>project</code> function above returns an object containing the overall population size over time.</p>
<p>This object also contains the population vectors of each timestep (the stage or age specific numbers). Rows represent one timestep and each column represents a stage.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/Projection-class.html">vec</a></span><span class="op">(</span><span class="va">Tortp</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">:</span><span class="fl">3</span>,<span class="op">]</span> <span class="co"># Here, we've limited the display to rows 1-3</span>
<span class="co">#&gt;             Yr        J1         J2         I1        I2         SA        A1</span>
<span class="co">#&gt; [1,] 0.1612628 0.1610072 0.03638508 0.18694399 0.1563224 0.08755404 0.1921181</span>
<span class="co">#&gt; [2,] 0.5415183 0.2067553 0.04462042 0.11833555 0.1314724 0.09453419 0.1852935</span>
<span class="co">#&gt; [3,] 0.5383570 0.5049573 0.05610631 0.07812311 0.1014334 0.09367547 0.1812237</span>
<span class="co">#&gt;              A2</span>
<span class="co">#&gt; [1,] 0.01840630</span>
<span class="co">#&gt; [2,] 0.01890331</span>
<span class="co">#&gt; [3,] 0.01922154</span></code></pre></div>
<p>Now, let’s plot the projected population.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Tortp</span>, log <span class="op">=</span><span class="st">"y"</span><span class="op">)</span></code></pre></div>
<p><img src="PopulationDynamics_files/figure-html/unnamed-chunk-6-1.png" width="576"></p>
<p><strong>Extra:</strong> Play around with the amount of time to which the model is projected (<code>time</code> argument above) and with your initial vector (<code>vec</code> argument above). What changes do you see (remember asymptotic vs. transient dymanics)?</p>
</div>
<div id="asymptotic-dynamics" class="section level2">
<h2 class="hasAnchor">
<a href="#asymptotic-dynamics" class="anchor"></a>Asymptotic dynamics</h2>
<p>In the long term, a population will reach a stable state and exhibit asymptotic growth. There are three major measures of asymptotic dynamics and are described by the dominant eigen data of the matrix:</p>
<ol style="list-style-type: decimal">
<li>Lambda; dominant eigenvalue: Asymptotic population growth rate</li>
<li>w; dominant right eigenvector: Proportion of individuals in each life stage when in a stable demographic distribution</li>
<li>v; dominant left eigenvector: Reproductive value vector</li>
</ol>
<p>We can calculate these three parameters in the following way:</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/eigs.html">eigs</a></span><span class="op">(</span><span class="va">Tort</span>, <span class="st">"all"</span><span class="op">)</span>
<span class="co">#&gt; $lambda</span>
<span class="co">#&gt; [1] 0.9580592</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $ss</span>
<span class="co">#&gt; [1] 0.22166176 0.40584601 0.15463401 0.06507518 0.03841807 0.03086514 0.07178663</span>
<span class="co">#&gt; [8] 0.01171319</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; $rv</span>
<span class="co">#&gt; [1] 0.1954968 0.2615887 0.6865549 1.8019036 2.7148109 4.8029132 4.3813423</span>
<span class="co">#&gt; [8] 5.1237087</span></code></pre></div>
<p>The <em>ss</em> vector refers to <strong>w</strong> and <em>rv</em> to <strong>v</strong>.</p>
<p><strong>w:</strong> The vector with the proportion of individuals in each stage once the population reaches a stable state. This vector can help us project a population that has theoretically reached stability. Lets project the tortoise population matrix with this vector (w).</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Tortw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/eigs.html">eigs</a></span><span class="op">(</span><span class="va">Tort</span>, <span class="st">"ss"</span><span class="op">)</span>
<span class="va">Tortpw</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/project.html">project</a></span><span class="op">(</span><span class="va">Tort</span>, <span class="va">Tortw</span>, time <span class="op">=</span> <span class="fl">50</span><span class="op">)</span></code></pre></div>
<p>We can plot the projected population and compare a population that has the actual ratios of the life stages (our random initial vector) with a population that has reached stability.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Tortp</span>, log <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="fl">50</span>, <span class="va">Tortpw</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span> <span class="co"># This line adds to the plot our recently projected population with the stable ratios</span></code></pre></div>
<p><img src="PopulationDynamics_files/figure-html/unnamed-chunk-9-1.png" width="576"></p>
</div>
<div id="transient-dynamics" class="section level2">
<h2 class="hasAnchor">
<a href="#transient-dynamics" class="anchor"></a>Transient dynamics</h2>
<p>Before a population reaches a stable state it goes through a series of oscillations, i.e., it declines/grows at a faster/slower rate than the asymptotic growth. These are called transient dynamics. These dynamics are harder to characterize as they are sensitive to the initial demographic distribution.</p>
<p>Let’s start with standardizations. To calculate deviations from stable growth, it is necessary to standardize the data. For comparative analyses, we often standardize for overall population size (because sizes of different populations in our dataset may vary) and measure transient dynamics relative to asymptotic growth (because different populations, with different matrices, have different growth rates).</p>
<p>The package <em>popdemo</em> has two different standardizations:</p>
<ol style="list-style-type: decimal">
<li>Standardize the initial vector so that it sums to 1
<ul>
<li>This is useful to assess the projection relative to initial population size (<code>standard.vec</code>)</li>
</ul>
</li>
<li>Scale the projection matrix by lambda
<ul>
<li>This standardizes asymptotic dynamics and makes it possible to asses transient dynamics</li>
</ul>
</li>
</ol>
<p>We can plot these standadizations.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">Tortps</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/project.html">project</a></span><span class="op">(</span><span class="va">Tort</span>, <span class="va">vec</span>, time <span class="op">=</span> <span class="fl">50</span>, 
                  standard.A <span class="op">=</span> <span class="cn">TRUE</span>, standard.vec <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="va">Tortpws</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/project.html">project</a></span><span class="op">(</span><span class="va">Tort</span>, <span class="va">Tortw</span>, time <span class="op">=</span> <span class="fl">50</span>, 
                   standard.A <span class="op">=</span> <span class="cn">TRUE</span>, standard.vec <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Tortps</span>, log <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Tortpws</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span></code></pre></div>
<p><img src="PopulationDynamics_files/figure-html/unnamed-chunk-10-1.png" width="576"></p>
</div>
<div id="damping-ratio" class="section level2">
<h2 class="hasAnchor">
<a href="#damping-ratio" class="anchor"></a>Damping ratio</h2>
<p>This is the rate of convergence to a stable state. The damping ratio does not tells us the time it will take a population to converge, but rather how fast. The higher the damping ratio, the faster it reaches convergence.</p>
<p>Calculate the damping ratio for the tortoise population.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/dr.html">dr</a></span><span class="op">(</span><span class="va">Tort</span><span class="op">)</span>
<span class="co">#&gt; [1] 1.141954</span></code></pre></div>
</div>
<div id="transient-indices" class="section level2">
<h2 class="hasAnchor">
<a href="#transient-indices" class="anchor"></a>Transient indices</h2>
<p>These are the maximum amplification and attenuation.</p>
<p>Comparable points at which to measure transient dynamics don’t have to be at the same time of the projection. Maximum amplification and maximum attenuation describe the largest and smallest population sizes (relative to long-term growth λ). Maximum amplification and maximum attenuation can occur at any point along the projection. Some populations only have a maximum amplification (because they never attenuate), some only have a maximum attenuation (because they never amplify), and some have both.</p>
<p>If we want to compare several different population structures, then it’s possible to project several simultaneously.</p>
<p>Here, we will: * Create two extra vectors * One that amplifies and one that attenuates * Bind these with the random vector into a matrix with 3 columns * Project the model with this matrix passed to the <code>vec</code> argument * Calculate maximum amplification and attenuation for the extra vectors * Plot these on the graph</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R">
<span class="co"># We'll start by creating three example populations</span>
<span class="va">TortAMP</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">5</span>, <span class="fl">8</span>, <span class="fl">13</span>, <span class="fl">21</span><span class="op">)</span> <span class="co"># A population that amplifies</span>
<span class="va">TortATT</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">21</span>, <span class="fl">13</span>, <span class="fl">8</span>, <span class="fl">5</span>, <span class="fl">3</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span> <span class="co"># A population that attenuates</span>
<span class="va">TortBTH</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span>, <span class="fl">0</span><span class="op">)</span> <span class="co"># A population that does both</span>

<span class="co"># Next, we'll bind them together</span>
<span class="va">Tortvec3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/cbind.html">cbind</a></span><span class="op">(</span>AMP <span class="op">=</span> <span class="va">TortAMP</span>, ATT <span class="op">=</span> <span class="va">TortATT</span>, BTH <span class="op">=</span> <span class="va">TortBTH</span><span class="op">)</span>

<span class="va">Tortvec3</span>
<span class="co">#&gt;      AMP ATT BTH</span>
<span class="co">#&gt; [1,]   1  21   0</span>
<span class="co">#&gt; [2,]   1  13   0</span>
<span class="co">#&gt; [3,]   2   8   0</span>
<span class="co">#&gt; [4,]   3   5   1</span>
<span class="co">#&gt; [5,]   5   3   0</span>
<span class="co">#&gt; [6,]   8   2   0</span>
<span class="co">#&gt; [7,]  13   1   0</span>
<span class="co">#&gt; [8,]  21   1   0</span>

<span class="co"># Let's project to 50 time intervals and standardize the vector to sum to 1 as we did in the earlier example</span>
<span class="va">Tortp3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/project.html">project</a></span><span class="op">(</span><span class="va">Tort</span>, <span class="va">Tortvec3</span>, time <span class="op">=</span> <span class="fl">50</span>, 
                  standard.A <span class="op">=</span> <span class="cn">TRUE</span>, standard.vec <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>

<span class="co"># Now, we'll define the points for amplification and attenuation</span>
<span class="va">max3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Tortvec3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">maxamp</span>, A <span class="op">=</span> <span class="va">Tort</span><span class="op">)</span>

<span class="va">max3t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Tortvec3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/maxamp.html">maxamp</a></span><span class="op">(</span>vector <span class="op">=</span> <span class="va">x</span>, A <span class="op">=</span> <span class="va">Tort</span>, return.t <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span><span class="op">$</span><span class="va">t</span><span class="op">}</span><span class="op">)</span>

<span class="va">min3</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Tortvec3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="va">maxatt</span>, A <span class="op">=</span> <span class="va">Tort</span><span class="op">)</span>

<span class="va">min3t</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/apply.html">apply</a></span><span class="op">(</span><span class="va">Tortvec3</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>,<span class="fl">3</span><span class="op">)</span><span class="op">]</span>, <span class="fl">2</span>, <span class="kw">function</span><span class="op">(</span><span class="va">x</span><span class="op">)</span><span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/pkg/popdemo/man/maxatt.html">maxatt</a></span><span class="op">(</span>vector <span class="op">=</span> <span class="va">x</span>, A <span class="op">=</span> <span class="va">Tort</span>, return.t <span class="op">=</span> <span class="cn">TRUE</span> <span class="op">)</span><span class="op">$</span><span class="va">t</span><span class="op">}</span><span class="op">)</span>

<span class="co"># And finally, let's plot</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html">plot</a></span><span class="op">(</span><span class="va">Tortp3</span>, log <span class="op">=</span> <span class="st">"y"</span><span class="op">)</span>; <span class="fu"><a href="https://rdrr.io/r/graphics/lines.html">lines</a></span><span class="op">(</span><span class="va">Tortpws</span>, lty <span class="op">=</span> <span class="fl">2</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">max3t</span>, <span class="va">min3t</span><span class="op">)</span>,
       <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="va">max3</span>, <span class="va">min3</span><span class="op">)</span>,
       pch <span class="op">=</span> <span class="fl">3</span>, col <span class="op">=</span> <span class="st">"red"</span><span class="op">)</span></code></pre></div>
<p><img src="PopulationDynamics_files/figure-html/unnamed-chunk-12-1.png" width="576"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
