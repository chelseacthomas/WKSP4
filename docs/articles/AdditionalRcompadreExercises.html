<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Additional Rcompadre Exercises • WKSP4</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Additional Rcompadre Exercises">
<meta property="og:description" content="WKSP4">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">WKSP4</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.1.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/AdditionalRcompadreExercises.html">Additional Rcompadre Exercises</a>
    </li>
    <li>
      <a href="../articles/OtherKeyLHTraits.html">Other key life history traits from MPMs</a>
    </li>
    <li>
      <a href="../articles/PopulationDynamics.html">Population dynamics</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="AdditionalRcompadreExercises_files/accessible-code-block-0.0.1/empty-anchor.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Additional Rcompadre Exercises</h1>
            
      
      
      <div class="hidden name"><code>AdditionalRcompadreExercises.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>These exercises accompany <em>Rcompadre</em> package vinettes found here. We will use the <em>Rcompadre</em> package for the following items.</p>
<ol style="list-style-type: decimal">
<li>Simple outputs from many matrices
<ul>
<li>Calculate population growth rate and damping ratio for COMPADRE/COMADRE data</li>
</ul>
</li>
<li>Geographic distribution
<ul>
<li>Plot a subset of COMPADRE/COMADRE data on a map</li>
</ul>
</li>
</ol>
</div>
<div id="preliminaries" class="section level2">
<h2 class="hasAnchor">
<a href="#preliminaries" class="anchor"></a>Preliminaries</h2>
<p>For these exercises, we’ll use the <em>Rcompadre</em>, <em>popbio</em>, and <em>maps</em> packages. The packages <em>popbio</em> and <em>maps</em> are available throught CRAN. Instructions for <em>Rcompadre</em> installation can be found <strong>here</strong>.</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">Rcompadre</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">popbio</span><span class="op">)</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va">maps</span><span class="op">)</span></code></pre></div>
</div>
<div id="simple-outputs-from-many-matrices" class="section level2">
<h2 class="hasAnchor">
<a href="#simple-outputs-from-many-matrices" class="anchor"></a>Simple outputs from many matrices</h2>
<p>This example produces some basic outputs such as the population growth rate (λ) and damping ratio (Caswell 2001) for a subset of species and populations given some selection criteria.</p>
<p>Begin by loading the COMADRE database. The latest version can be found <strong>here</strong> or pulled using the <em>Rcompadre</em> package with the code below.</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/load.html">load</a></span><span class="op">(</span><span class="st">"COMADRE_v.4.20.11.1.RData"</span><span class="op">)</span></code></pre></div>
<p><strong>Important note:</strong> If using the <code>cdb_fetch</code> function, the database is automatically converted to an S4 object.</p>
<p>Once the database is loaded, we’ll use <code>as_cdb</code> (from the <em>Rcompadre</em> package) to make the loaded database into an S4 COMPADRE object. Then, we’ll subset the database to our data of interest: only mean matrices for bony fish from studies of 3 years in duration or longer, and with a matrix dimension of 3 or greater.</p>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">comadre</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/Rcompadre/man/as_cdb.html">as_cdb</a></span><span class="op">(</span><span class="va">comadre</span><span class="op">)</span> <span class="co"># Converts the S3 database format from the website into S4</span>

<span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">comadre</span>, <span class="va">MatrixComposite</span> <span class="op">==</span> <span class="st">"Mean"</span> <span class="op">&amp;</span> <span class="co"># Subsets the database based on variables in the metadata</span>
              <span class="va">Class</span> <span class="op">==</span> <span class="st">"Actinopterygii"</span> <span class="op">&amp;</span> 
              <span class="va">StudyDuration</span> <span class="op">&gt;=</span> <span class="fl">3</span> <span class="op">&amp;</span>
              <span class="va">MatrixDimension</span> <span class="op">&gt;</span> <span class="fl">3</span><span class="op">)</span></code></pre></div>
<p>The object <code>x</code> is now a version of the COMADRE database object that contains only the matrices that match the search criteria.</p>
<p>These matrices can now be analyzed by applying functions in a loop, or by using <code>lapply</code>. For example, to calculate population growth rate and damping ratio for the subset of matrices, first create an empty <code>data.frame</code> to accommodate the output using <em>popbio</em>.</p>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>lambdas <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span>, damps <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html">rep</a></span><span class="op">(</span><span class="cn">NA</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="va">output</span><span class="op">$</span><span class="va">lambdas</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html">Re</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">mat</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">matA</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
  <span class="va">output</span><span class="op">$</span><span class="va">damps</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/popbio/man/damping.ratio.html">damping.ratio</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">mat</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">matA</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Let’s examine the output.</p>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">output</span>
<span class="co">#&gt;     lambdas    damps</span>
<span class="co">#&gt; 1 1.5061504 1.303947</span>
<span class="co">#&gt; 2 0.7459078 1.432266</span>
<span class="co">#&gt; 3 0.9176391 1.397521</span>
<span class="co">#&gt; 4 1.3501445 1.697755</span>
<span class="co">#&gt; 5 2.3156105 1.303005</span>
<span class="co">#&gt; 6 0.9091956 1.031997</span>
<span class="co">#&gt; 7 0.9027406 1.027850</span>
<span class="co">#&gt; 8 0.9140835 1.035914</span>
<span class="co">#&gt; 9 0.9999592 1.005268</span></code></pre></div>
<p>These parameters are presented in the same order as the metadata so we could also add the species name to this data.frame.</p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>Species <span class="op">=</span> <span class="va">x</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">SpeciesAccepted</span>, <span class="va">output</span><span class="op">)</span>
<span class="co">#&gt;                      Species   lambdas    damps</span>
<span class="co">#&gt; 1       Ammocrypta pellucida 1.5061504 1.303947</span>
<span class="co">#&gt; 2   Catostomus platyrhynchus 0.7459078 1.432266</span>
<span class="co">#&gt; 3                 Cottus sp. 0.9176391 1.397521</span>
<span class="co">#&gt; 4           Erimyzon sucetta 1.3501445 1.697755</span>
<span class="co">#&gt; 5      Hybognathus argyritis 2.3156105 1.303005</span>
<span class="co">#&gt; 6   Oncorhynchus tshawytscha 0.9091956 1.031997</span>
<span class="co">#&gt; 7   Oncorhynchus tshawytscha 0.9027406 1.027850</span>
<span class="co">#&gt; 8   Oncorhynchus tshawytscha 0.9140835 1.035914</span>
<span class="co">#&gt; 9 Sprattus sprattus balticus 0.9999592 1.005268</span></code></pre></div>
<p>We can also plot the population growth rates and damping ratios derived from these matrices. In the plot below, the vertical, dashed red line indicates population growth rate = 1 (or log(λ) = 0).</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">log</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">lambdas</span><span class="op">)</span>,xlab <span class="op">=</span> <span class="st">"Log population growth rate"</span>, col <span class="op">=</span> <span class="st">"gold"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span><span class="op">(</span>v<span class="op">=</span><span class="fl">0</span>,col <span class="op">=</span> <span class="st">"red"</span>, lwd <span class="op">=</span> <span class="fl">4</span>, lty <span class="op">=</span> <span class="fl">3</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/graphics/hist.html">hist</a></span><span class="op">(</span><span class="va">output</span><span class="op">$</span><span class="va">damps</span>, xlab <span class="op">=</span> <span class="st">"Damping ratio"</span>, col <span class="op">=</span> <span class="st">"brown"</span>, main <span class="op">=</span> <span class="st">""</span><span class="op">)</span></code></pre></div>
<p><img src="AdditionalRcompadreExercises_files/figure-html/unnamed-chunk-7-1.png" width="576"></p>
</div>
<div id="geographic-distribution" class="section level2">
<h2 class="hasAnchor">
<a href="#geographic-distribution" class="anchor"></a>Geographic distribution</h2>
<p>This example produces on a world map with the viability (population growth rate λ &gt; 1, λ = 1, λ &lt; 1) of a subset of studied populations given some selection criteria and color-codes the location of each population according to the value of λ.</p>
<p>First, we’ll subset mean matrices for all Carnivora in the wild in the northern hemisphere, with no issues for survival &gt; 1, for which matrices have been split into <strong>A</strong> = <strong>U</strong> + <strong>F</strong> + <strong>C</strong>, and for which reproduction was explicitly modeled.</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/subset.html">subset</a></span><span class="op">(</span><span class="va">comadre</span>, <span class="va">MatrixComposite</span> <span class="op">==</span> <span class="st">"Mean"</span> <span class="op">&amp;</span>
              <span class="va">Order</span> <span class="op">==</span> <span class="st">"Carnivora"</span> <span class="op">&amp;</span>
              <span class="va">MatrixCaptivity</span> <span class="op">==</span> <span class="st">"W"</span> <span class="op">&amp;</span>
              <span class="va">Lat</span> <span class="op">&gt;</span> <span class="fl">0</span> <span class="op">&amp;</span>
              <span class="va">SurvivalIssue</span> <span class="op">&lt;</span> <span class="fl">1</span> <span class="op">&amp;</span>
              <span class="va">MatrixSplit</span> <span class="op">==</span> <span class="st">"Divided"</span> <span class="op">&amp;</span>
              <span class="va">MatrixFec</span> <span class="op">==</span> <span class="st">"Yes"</span><span class="op">)</span></code></pre></div>
<p>The object <code>x</code> is now a version of the COMADRE database object that contains only the matrices that match the search criteria. To calculate population growth rate for the subset matrices, we’ll first create an empty variable to accommodate the output from lambda calculations.</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">lambdas</span> <span class="op">&lt;-</span> <span class="cn">NA</span></code></pre></div>
<p>Then, we’ll create a <code>for</code> loop to examine each matrix in turn. Here, it may be advisable to use the function <code>tryCatch</code> as a wrapper to cope with the situation if/when the function in the loop fails.</p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="kw">for</span> <span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">mat</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>
  <span class="kw"><a href="https://rdrr.io/r/base/conditions.html">tryCatch</a></span><span class="op">(</span><span class="op">{</span>
    <span class="va">x</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">lambdas</span><span class="op">[</span><span class="va">i</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/complex.html">Re</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/eigen.html">eigen</a></span><span class="op">(</span><span class="va">x</span><span class="op">$</span><span class="va">mat</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">@</span><span class="va">matA</span><span class="op">)</span><span class="op">$</span><span class="va">value</span><span class="op">)</span><span class="op">[</span><span class="fl">1</span><span class="op">]</span>
    <span class="op">}</span>, error <span class="op">=</span> <span class="kw">function</span><span class="op">(</span><span class="va">e</span><span class="op">)</span><span class="op">{</span><span class="op">}</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p>Now, we’ll create a vector of color hex codes that can be applied according to the estimate of λ. This is done using the <code>colorRampPalette</code> function to go from green for high values of λ to red for low values of λ. Here, paste is used to append a value of 90 to the hex codes to allow transparency for aesthetic reasons.</p>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">rampfunc</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/grDevices/colorRamp.html">colorRampPalette</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"green"</span>, <span class="st">"red"</span><span class="op">)</span><span class="op">)</span>
<span class="va">colVect</span> <span class="op">&lt;-</span> <span class="fu">rampfunc</span><span class="op">(</span><span class="fl">100</span><span class="op">)</span>
<span class="va">colVect</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="va">colVect</span>, <span class="st">"90"</span>, sep <span class="op">=</span> <span class="st">""</span><span class="op">)</span>
<span class="va">s1</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/seq.html">seq</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">min</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">lambdas</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,<span class="fu"><a href="https://rdrr.io/r/base/Extremes.html">max</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">lambdas</span>, na.rm<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>,
          length.out <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<p>Using the <em>maps</em> package, we’ll plot the world map and overlay the points from our data, color coded by value of λ. In this case, the points are jittered slightly to improve visibility of nearby populations.</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span><span class="op">(</span>mfrow <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">1</span><span class="op">)</span><span class="op">)</span>
<span class="op">{</span><span class="fu"><a href="https://rdrr.io/pkg/maps/man/map.html">map</a></span><span class="op">(</span><span class="st">"world"</span>, col <span class="op">=</span> <span class="st">"gray"</span>, fill <span class="op">=</span> <span class="cn">TRUE</span>, bg <span class="op">=</span> <span class="st">"light blue"</span>,
    xlim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">175</span>, <span class="fl">176</span><span class="op">)</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">60</span>, <span class="fl">85</span><span class="op">)</span>, border <span class="op">=</span> <span class="st">"white"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/points.html">points</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">Lon</span>, <span class="fl">0.6</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/jitter.html">jitter</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">Lat</span>, <span class="fl">0.6</span><span class="op">)</span>,
       col <span class="op">=</span> <span class="va">colVect</span><span class="op">[</span><span class="fu"><a href="https://rdrr.io/r/base/findInterval.html">findInterval</a></span><span class="op">(</span><span class="va">x</span><span class="op">@</span><span class="va">data</span><span class="op">$</span><span class="va">lambdas</span>, <span class="va">s1</span><span class="op">)</span><span class="op">]</span>, cex <span class="op">=</span> <span class="fl">2</span>, pch <span class="op">=</span> <span class="fl">16</span><span class="op">)</span>
<span class="op">}</span></code></pre></div>
<p><img src="AdditionalRcompadreExercises_files/figure-html/unnamed-chunk-12-1.png" width="672"></p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by The package maintainer.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
